step 0: train loss 7.8260
saving checkpoint tp out
time -> one epoch of dataloader : 6.549593687057495
step 1: train loss 7.8229
saving checkpoint tp out
time -> one epoch of dataloader : 6.890791893005371
step 2: train loss 7.8066
saving checkpoint tp out
time -> one epoch of dataloader : 7.334566831588745
step 3: train loss 7.7804
saving checkpoint tp out
time -> one epoch of dataloader : 8.034660816192627
step 4: train loss 7.7859
saving checkpoint tp out
time -> one epoch of dataloader : 8.978041172027588
step 5: train loss 7.8216
saving checkpoint tp out
time -> one epoch of dataloader : 10.101892232894897
step 6: train loss 7.8206
saving checkpoint tp out
time -> one epoch of dataloader : 11.097789764404297
step 7: train loss 7.8296
saving checkpoint tp out
time -> one epoch of dataloader : 11.832287549972534
step 8: train loss 7.8143
saving checkpoint tp out
time -> one epoch of dataloader : 12.496183395385742
step 9: train loss 7.8216
saving checkpoint tp out
time -> one epoch of dataloader : 13.288254261016846
step 10: train loss 7.7964
saving checkpoint tp out
time -> one epoch of dataloader : 14.059586524963379
step 11: train loss 7.8217
saving checkpoint tp out
time -> one epoch of dataloader : 14.720330953598022
step 12: train loss 7.8332
saving checkpoint tp out
time -> one epoch of dataloader : 15.369311094284058
step 13: train loss 7.8004
saving checkpoint tp out
time -> one epoch of dataloader : 15.969476461410522
step 14: train loss 7.8198
saving checkpoint tp out
time -> one epoch of dataloader : 16.59502339363098
step 15: train loss 7.8149
saving checkpoint tp out
time -> one epoch of dataloader : 17.179696559906006
step 16: train loss 7.8098
saving checkpoint tp out
time -> one epoch of dataloader : 17.810439586639404
step 17: train loss 7.7994
saving checkpoint tp out
time -> one epoch of dataloader : 18.420653343200684
step 18: train loss 7.8050
saving checkpoint tp out
time -> one epoch of dataloader : 18.98142433166504
step 19: train loss 7.8173
saving checkpoint tp out
time -> one epoch of dataloader : 19.58953022956848
step 20: train loss 7.8209
saving checkpoint tp out
time -> one epoch of dataloader : 20.130724668502808
step 21: train loss 7.8207
saving checkpoint tp out
time -> one epoch of dataloader : 20.71284556388855
step 22: train loss 7.8212
saving checkpoint tp out
time -> one epoch of dataloader : 21.28617024421692
step 23: train loss 7.7932
saving checkpoint tp out
time -> one epoch of dataloader : 21.89962649345398
step 24: train loss 7.8262
saving checkpoint tp out
time -> one epoch of dataloader : 22.417059898376465
step 25: train loss 7.8197
saving checkpoint tp out
time -> one epoch of dataloader : 22.954683542251587
step 26: train loss 7.8195
saving checkpoint tp out
time -> one epoch of dataloader : 23.4338538646698
step 27: train loss 7.7872
saving checkpoint tp out
time -> one epoch of dataloader : 23.91737937927246
step 28: train loss 7.8090
saving checkpoint tp out
time -> one epoch of dataloader : 24.411649227142334
step 29: train loss 7.8030
saving checkpoint tp out
time -> one epoch of dataloader : 24.877137899398804
step 30: train loss 7.8135
saving checkpoint tp out
time -> one epoch of dataloader : 25.369767904281616
step 31: train loss 7.8282
saving checkpoint tp out
time -> one epoch of dataloader : 25.913920640945435
step 32: train loss 7.8093
saving checkpoint tp out
time -> one epoch of dataloader : 26.38532066345215
step 33: train loss 7.8202
saving checkpoint tp out
time -> one epoch of dataloader : 26.896448135375977
step 34: train loss 7.8028
saving checkpoint tp out
time -> one epoch of dataloader : 27.345267057418823
step 35: train loss 7.8060
saving checkpoint tp out
time -> one epoch of dataloader : 27.87051749229431
step 36: train loss 7.8151
saving checkpoint tp out
time -> one epoch of dataloader : 28.394946098327637
step 37: train loss 7.8158
saving checkpoint tp out
time -> one epoch of dataloader : 28.92177677154541
step 38: train loss 7.8162
saving checkpoint tp out
time -> one epoch of dataloader : 29.399431467056274
step 39: train loss 7.8080
saving checkpoint tp out
time -> one epoch of dataloader : 29.85358762741089
step 40: train loss 7.8294
saving checkpoint tp out
time -> one epoch of dataloader : 30.407570838928223
step 41: train loss 7.7926
saving checkpoint tp out
time -> one epoch of dataloader : 30.85929036140442
step 42: train loss 7.7810
saving checkpoint tp out
time -> one epoch of dataloader : 31.333019495010376
step 43: train loss 7.8319
saving checkpoint tp out
time -> one epoch of dataloader : 31.80129647254944
step 44: train loss 7.8228
saving checkpoint tp out
time -> one epoch of dataloader : 32.25962424278259
step 45: train loss 7.7775
saving checkpoint tp out
time -> one epoch of dataloader : 32.762913942337036
step 46: train loss 7.7979
saving checkpoint tp out
time -> one epoch of dataloader : 33.17471885681152
step 47: train loss 7.8013
saving checkpoint tp out
time -> one epoch of dataloader : 33.667760372161865
step 48: train loss 7.7985
saving checkpoint tp out
time -> one epoch of dataloader : 34.11932158470154
step 49: train loss 7.7814
saving checkpoint tp out
time -> one epoch of dataloader : 34.607507944107056
step 50: train loss 7.8081
saving checkpoint tp out
time -> one epoch of dataloader : 35.039270877838135
step 51: train loss 7.7761
saving checkpoint tp out
time -> one epoch of dataloader : 35.48968172073364
step 52: train loss 7.8046
saving checkpoint tp out
time -> one epoch of dataloader : 36.03525376319885
step 53: train loss 7.8409
saving checkpoint tp out
time -> one epoch of dataloader : 36.48378920555115
step 54: train loss 7.7970
saving checkpoint tp out
time -> one epoch of dataloader : 36.97546887397766
step 55: train loss 7.8023
saving checkpoint tp out
time -> one epoch of dataloader : 37.39934039115906
step 56: train loss 7.8005
saving checkpoint tp out
time -> one epoch of dataloader : 37.879483699798584
step 57: train loss 7.7547
saving checkpoint tp out
time -> one epoch of dataloader : 38.36720871925354
step 58: train loss 7.7681
saving checkpoint tp out
time -> one epoch of dataloader : 38.84354209899902
step 59: train loss 7.7788
saving checkpoint tp out
time -> one epoch of dataloader : 39.35955309867859
step 60: train loss 7.7737
saving checkpoint tp out
time -> one epoch of dataloader : 39.818037271499634
step 61: train loss 7.7881
saving checkpoint tp out
time -> one epoch of dataloader : 40.31932091712952
step 62: train loss 7.7404
saving checkpoint tp out
time -> one epoch of dataloader : 40.78274607658386
step 63: train loss 7.7983
saving checkpoint tp out
time -> one epoch of dataloader : 41.267239809036255
step 64: train loss 7.7761
saving checkpoint tp out
time -> one epoch of dataloader : 41.74233651161194
step 65: train loss 7.7967
saving checkpoint tp out
time -> one epoch of dataloader : 42.27804350852966
step 66: train loss 7.7581
saving checkpoint tp out
time -> one epoch of dataloader : 42.83623194694519
step 67: train loss 7.7857
saving checkpoint tp out
time -> one epoch of dataloader : 43.32857942581177
step 68: train loss 7.7837
saving checkpoint tp out
time -> one epoch of dataloader : 43.80158448219299
step 69: train loss 7.7786
saving checkpoint tp out
time -> one epoch of dataloader : 44.32963156700134
step 70: train loss 7.7745
saving checkpoint tp out
time -> one epoch of dataloader : 44.968199729919434
step 71: train loss 7.7974
saving checkpoint tp out
time -> one epoch of dataloader : 45.599549770355225
step 72: train loss 7.7420
saving checkpoint tp out
time -> one epoch of dataloader : 46.29678463935852
step 73: train loss 7.7741
saving checkpoint tp out
time -> one epoch of dataloader : 46.89834237098694
step 74: train loss 7.7576
saving checkpoint tp out
time -> one epoch of dataloader : 47.40957570075989
step 75: train loss 7.7596
saving checkpoint tp out
time -> one epoch of dataloader : 47.89730358123779
step 76: train loss 7.7768
saving checkpoint tp out
time -> one epoch of dataloader : 48.34803795814514
step 77: train loss 7.7761
saving checkpoint tp out
time -> one epoch of dataloader : 48.85926127433777
step 78: train loss 7.7389
saving checkpoint tp out
time -> one epoch of dataloader : 49.36041331291199
step 79: train loss 7.7535
saving checkpoint tp out
time -> one epoch of dataloader : 49.85940933227539
step 80: train loss 7.7266
saving checkpoint tp out
time -> one epoch of dataloader : 50.426090240478516
step 81: train loss 7.7649
saving checkpoint tp out
time -> one epoch of dataloader : 50.97615170478821
step 82: train loss 7.7503
saving checkpoint tp out
time -> one epoch of dataloader : 51.49929094314575
step 83: train loss 7.7604
saving checkpoint tp out
time -> one epoch of dataloader : 51.959625005722046
step 84: train loss 7.7534
saving checkpoint tp out
time -> one epoch of dataloader : 52.41815185546875
step 85: train loss 7.7494
saving checkpoint tp out
time -> one epoch of dataloader : 52.90968346595764
step 86: train loss 7.7421
saving checkpoint tp out
time -> one epoch of dataloader : 53.399473428726196
step 87: train loss 7.7242
saving checkpoint tp out
time -> one epoch of dataloader : 53.86496424674988
step 88: train loss 7.7483
saving checkpoint tp out
time -> one epoch of dataloader : 54.36977982521057
step 89: train loss 7.7667
saving checkpoint tp out
time -> one epoch of dataloader : 54.83200931549072
step 90: train loss 7.7467
saving checkpoint tp out
time -> one epoch of dataloader : 55.37454056739807
step 91: train loss 7.7363
saving checkpoint tp out
time -> one epoch of dataloader : 55.84124159812927
step 92: train loss 7.7417
saving checkpoint tp out
time -> one epoch of dataloader : 56.45314407348633
step 93: train loss 7.7380
saving checkpoint tp out
time -> one epoch of dataloader : 56.94175863265991
step 94: train loss 7.7273
saving checkpoint tp out
time -> one epoch of dataloader : 57.45326590538025
step 95: train loss 7.7236
saving checkpoint tp out
time -> one epoch of dataloader : 57.93972659111023
step 96: train loss 7.7586
saving checkpoint tp out
time -> one epoch of dataloader : 58.39815354347229
step 97: train loss 7.7331
saving checkpoint tp out
time -> one epoch of dataloader : 58.926026344299316
step 98: train loss 7.7264
saving checkpoint tp out
time -> one epoch of dataloader : 59.38764452934265
step 99: train loss 7.7351
saving checkpoint tp out
time -> one epoch of dataloader : 59.86214900016785
step 100: train loss 7.7378
saving checkpoint tp out
time -> one epoch of dataloader : 60.3596134185791
step 101: train loss 7.7232
saving checkpoint tp out
time -> one epoch of dataloader : 60.829418659210205
step 102: train loss 7.7237
saving checkpoint tp out
time -> one epoch of dataloader : 61.34520745277405
step 103: train loss 7.6992
saving checkpoint tp out
time -> one epoch of dataloader : 61.83067274093628
step 104: train loss 7.7018
saving checkpoint tp out
time -> one epoch of dataloader : 62.31939911842346
step 105: train loss 7.7154
saving checkpoint tp out
time -> one epoch of dataloader : 62.84438610076904
step 106: train loss 7.7095
saving checkpoint tp out
time -> one epoch of dataloader : 63.30725884437561
step 107: train loss 7.7294
saving checkpoint tp out
time -> one epoch of dataloader : 63.81526803970337
step 108: train loss 7.7210
saving checkpoint tp out
time -> one epoch of dataloader : 64.30797219276428
step 109: train loss 7.7101
saving checkpoint tp out
time -> one epoch of dataloader : 64.76241540908813
step 110: train loss 7.6985
saving checkpoint tp out
time -> one epoch of dataloader : 65.30042767524719
step 111: train loss 7.7098
saving checkpoint tp out
time -> one epoch of dataloader : 65.79075789451599
step 112: train loss 7.6969
saving checkpoint tp out
Traceback (most recent call last):
  File "C:\Users\SHIVA SINGH\OneDrive\Documents\LLM\refined\atrain.py", line 346, in <module>
    t.train(1)
  File "C:\Users\SHIVA SINGH\OneDrive\Documents\LLM\refined\atrain.py", line 251, in train
    losses = self.estimate_loss(['train'])
  File "C:\Users\SHIVA SINGH\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\utils\_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "C:\Users\SHIVA SINGH\OneDrive\Documents\LLM\refined\atrain.py", line 301, in estimate_loss
    logits, loss = self.model(x,y)
  File "C:\Users\SHIVA SINGH\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\modules\module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\SHIVA SINGH\OneDrive\Documents\LLM\refined\atrain.py", line 106, in forward
    loss = F.cross_entropy(logits,target)
  File "C:\Users\SHIVA SINGH\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\nn\functional.py", line 3029, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
KeyboardInterrupt
time -> one epoch of dataloader : 66.32282328605652